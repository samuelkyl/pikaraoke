{% extends 'base.html' %} {% block scripts %}
<script>
  $(function () {
    $("#quit-link").click(function (e) {
      e.preventDefault();
      if (window.confirm("Are you sure you want to quit?")) {
        location.href = this.href;
      }
    });

    $("#shutdown-link").click(function (e) {
      e.preventDefault();
      if (window.confirm("Are you sure you want to shut down?")) {
        location.href = this.href;
      }
    });

    $("#restart-link").click(function (e) {
      e.preventDefault();
      if (window.confirm("Are you sure you want to reboot?")) {
        location.href = this.href;
      }
    });

    $("#update-ytdl-link").click(function (e) {
      e.preventDefault();
      if (window.confirm("Are you sure you want to update Youtube-dl right now? Current and pending downloads may fail.")) {
        location.href = this.href;
      }
    });

    $("#expand-link").click(function (e) {
      e.preventDefault();
      if (window.confirm("Are you sure you want to expand the filesystem? This will reboot your raspberry pi.")) {
        location.href = this.href;
      }
    });

    $("#use-DNN").change(function(){
      $.get("/set_vocal_mode/" + this.checked, function( data ){
        location.reload();
      });
    });

    $("#streamer-stop").click(function(){
      $.get("/bg-process/streamer-stop", function (data) { location.reload(); });
    });

    $("#streamer-restart").click(function(){
      $.get("/bg-process/streamer-restart", function (data){ location.reload(); });
    });

    $("#vocal-stop").click(function(){
      $.get("/bg-process/vocal-stop", function (data) { location.reload(); });
    });

    $("#vocal-restart").click(function(){
      $.get("/bg-process/vocal-restart", function (data){ location.reload(); });
    });
  });
</script>
{% endblock %} {% block header %}
<style>
.help-normal {
  font-size: 1em;
}

.switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  -webkit-transition: .4s;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked + .slider {
  background-color: #2196F3;
}

input:focus + .slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked + .slider:before {
  -webkit-transform: translateX(26px);
  -ms-transform: translateX(26px);
  transform: translateX(26px);
}

/* Rounded sliders */
.slider.round {
  border-radius: 34px;
}

.slider.round:before {
  border-radius: 50%;
}

.button::-moz-focus-inner{
  border: 0;
  padding: 0;
}

.button{
  display: inline-block;
  *display: inline;
  zoom: 1;
  padding: 6px 20px;
  margin: 0;
  cursor: pointer;
  border: 1px solid #bbb;
  overflow: visible;
  font: bold 13px arial, helvetica, sans-serif;
  text-decoration: none;
  white-space: nowrap;
  color: #555;

  background-color: #ddd;
  background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(255,255,255,1)), to(rgba(255,255,255,0)));
  background-image: -webkit-linear-gradient(top, rgba(255,255,255,1), rgba(255,255,255,0));
  background-image: -moz-linear-gradient(top, rgba(255,255,255,1), rgba(255,255,255,0));
  background-image: -ms-linear-gradient(top, rgba(255,255,255,1), rgba(255,255,255,0));
  background-image: -o-linear-gradient(top, rgba(255,255,255,1), rgba(255,255,255,0));
  background-image: linear-gradient(top, rgba(255,255,255,1), rgba(255,255,255,0));

  -webkit-transition: background-color .2s ease-out;
  -moz-transition: background-color .2s ease-out;
  -ms-transition: background-color .2s ease-out;
  -o-transition: background-color .2s ease-out;
  transition: background-color .2s ease-out;
  background-clip: padding-box; /* Fix bleeding */
  -moz-border-radius: 3px;
  -webkit-border-radius: 3px;
  border-radius: 3px;
  -moz-box-shadow: 0 1px 0 rgba(0, 0, 0, .3), 0 2px 2px -1px rgba(0, 0, 0, .5), 0 1px 0 rgba(255, 255, 255, .3) inset;
  -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, .3), 0 2px 2px -1px rgba(0, 0, 0, .5), 0 1px 0 rgba(255, 255, 255, .3) inset;
  box-shadow: 0 1px 0 rgba(0, 0, 0, .3), 0 2px 2px -1px rgba(0, 0, 0, .5), 0 1px 0 rgba(255, 255, 255, .3) inset;
  text-shadow: 0 1px 0 rgba(255,255,255, .9);

  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.button:hover{
  background-color: #eee;
  color: #555;
}

.button:active{
  background: #e9e9e9;
  position: relative;
  top: 1px;
  text-shadow: none;
  -moz-box-shadow: 0 1px 1px rgba(0, 0, 0, .3) inset;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, .3) inset;
  box-shadow: 0 1px 1px rgba(0, 0, 0, .3) inset;
}

.button[disabled], .button[disabled]:hover, .button[disabled]:active{
  border-color: #eaeaea;
  background: #fafafa;
  cursor: default;
  position: static;
  color: #999;
  /* Usually, !important should be avoided but here it's really needed :) */
  -moz-box-shadow: none !important;
  -webkit-box-shadow: none !important;
  box-shadow: none !important;
  text-shadow: none !important;
}

/* Smaller buttons styles */

.button.small{
  padding: 4px 12px;
}

/* Colored buttons styles */

.button.green, .button.red, .button.blue {
  color: #fff;
  text-shadow: 0 1px 0 rgba(0,0,0,.2);

  background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(255,255,255,.3)), to(rgba(255,255,255,0)));
  background-image: -webkit-linear-gradient(top, rgba(255,255,255,.3), rgba(255,255,255,0));
  background-image: -moz-linear-gradient(top, rgba(255,255,255,.3), rgba(255,255,255,0));
  background-image: -ms-linear-gradient(top, rgba(255,255,255,.3), rgba(255,255,255,0));
  background-image: -o-linear-gradient(top, rgba(255,255,255,.3), rgba(255,255,255,0));
  background-image: linear-gradient(top, rgba(255,255,255,.3), rgba(255,255,255,0));
}

/* */

.button.green{
  background-color: #57a957;
  border-color: #57a957;
}

.button.green:hover{
  background-color: #62c462;
}

.button.green:active{
  background: #57a957;
}

/* */

.button.red{
  background-color: #ca3535;
  border-color: #c43c35;
}

.button.red:hover{
  background-color: #ee5f5b;
}

.button.red:active{
  background: #c43c35;
}

/* */

.button.blue{
  background-color: #269CE9;
  border-color: #269CE9;
}

.button.blue:hover{
  background-color: #70B9E8;
}

.button.blue:active{
  background: #269CE9;
}

/* */

.green[disabled], .green[disabled]:hover, .green[disabled]:active{
  border-color: #57A957;
  background: #57A957;
  color: #D2FFD2;
}

.red[disabled], .red[disabled]:hover, .red[disabled]:active{
  border-color: #C43C35;
  background: #C43C35;
  color: #FFD3D3;
}

.blue[disabled], .blue[disabled]:hover, .blue[disabled]:active{
  border-color: #269CE9;
  background: #269CE9;
  color: #93D5FF;
}

/* Group buttons */

.button-group,
.button-group li{
  display: inline-block;
  *display: inline;
  zoom: 1;
}

.button-group{
  font-size: 0; /* Inline block elements gap - fix */
  margin: 0;
  padding: 0;
  background: rgba(0, 0, 0, .1);
  border-bottom: 1px solid rgba(0, 0, 0, .1);
  padding: 7px;
  -moz-border-radius: 7px;
  -webkit-border-radius: 7px;
  border-radius: 7px;
}

.button-group li{
  margin-right: -1px; /* Overlap each right button border */
}

.button-group .button{
  font-size: 13px; /* Set the font size, different from inherited 0 */
  -moz-border-radius: 0;
  -webkit-border-radius: 0;
  border-radius: 0;
}

.button-group .button:active{
  -moz-box-shadow: 0 0 1px rgba(0, 0, 0, .2) inset, 5px 0 5px -3px rgba(0, 0, 0, .2) inset, -5px 0 5px -3px rgba(0, 0, 0, .2) inset;
  -webkit-box-shadow: 0 0 1px rgba(0, 0, 0, .2) inset, 5px 0 5px -3px rgba(0, 0, 0, .2) inset, -5px 0 5px -3px rgba(0, 0, 0, .2) inset;
  box-shadow: 0 0 1px rgba(0, 0, 0, .2) inset, 5px 0 5px -3px rgba(0, 0, 0, .2) inset, -5px 0 5px -3px rgba(0, 0, 0, .2) inset;
}

.button-group li:first-child .button{
  -moz-border-radius: 3px 0 0 3px;
  -webkit-border-radius: 3px 0 0 3px;
  border-radius: 3px 0 0 3px;
}

.button-group li:first-child .button:active{
  -moz-box-shadow: 0 0 1px rgba(0, 0, 0, .2) inset, -5px 0 5px -3px rgba(0, 0, 0, .2) inset;
  -webkit-box-shadow: 0 0 1px rgba(0, 0, 0, .2) inset, -5px 0 5px -3px rgba(0, 0, 0, .2) inset;
  box-shadow: 0 0 1px rgba(0, 0, 0, .2) inset, -5px 0 5px -3px rgba(0, 0, 0, .2) inset;
}

.button-group li:last-child .button{
  -moz-border-radius: 0 3px 3px 0;
  -webkit-border-radius: 0 3px 3px 0;
  border-radius: 0 3px 3px 0;
}

.button-group li:last-child .button:active{
  -moz-box-shadow: 0 0 1px rgba(0, 0, 0, .2) inset, 5px 0 5px -3px rgba(0, 0, 0, .2) inset;
  -webkit-box-shadow: 0 0 1px rgba(0, 0, 0, .2) inset, 5px 0 5px -3px rgba(0, 0, 0, .2) inset;
  box-shadow: 0 0 1px rgba(0, 0, 0, .2) inset, 5px 0 5px -3px rgba(0, 0, 0, .2) inset;
}
</style>

<h1>{% block title %}Information{% endblock %}</h1>
{% endblock %} {% block content %}

<hr/>


<div class="has-text-centered">
  <p>URL of {{site_title}}:</p>
  <p class="is-size-4 has-text-warning has-text-centered">{{ url }}</p>
  <p>Handy URL QR code to share with a pal:</p>
<img id="qr-img" width="300px" src="{{ url_for('qrcode') }}" style="image-rendering: pixelated" />
</div>

<hr />

<h1>System Info</h1>
<ul>
  <li>CPU: {{ cpu }}</li>
  <li>Disk Usage: {{ disk }}</li>
  <li>Memory: {{ memory }}</li>
  {% if platform == 'linux' %} <li>Screen Capture: {{ screencapture }}</li> {% endif %}
  <li>Vocal Splitter: {{ vocalsplitter }}</li>
  <li>Youtube-dl (yt-dlp) version: {{ youtubedl_version }}</li>
  <li>Pikaraoke version: {{ pikaraoke_version }}</li>
</ul>

<hr />

{% if admin %}
<h2>Advanced Control Options</h2>
<h4>Vocal splitter mode:</h4>
<div class="is-flex" style="align-items:center">
  <span style="vertical-align:middle; text-align:center;">Use L-R/L+R</span>
  <label style="vertical-align:middle; margin: 5px" class="switch">
    <input id="use-DNN" type="checkbox" {% if use_DNN %}checked{% endif %}>
    <span class="slider round"></span>
  </label>
  <span style="vertical-align:middle; text-align:center;">Use DNN</span>
</div>
<p class="help">Standard MTV audio has the two stereo channels (L and R) encoded in such a way that:
  L-R is the instrument track, L+R is the vocal track. Thus, by simply subtracting or adding the two stereo channels,
  we can get the instrumental and vocal track in mono sound. PiKaraoke's built-in DNN-based (deep neural network)
  vocal splitter uses AI algorithm to split instrumental and vocal sound in each stereo track independently resulting in
  stereo instrumental and vocal tracks.</p>

<h4 style="margin-bottom:0">Vocal splitter:</h4>
<ul class="button-group">
  <li><button id="vocal-stop" class="red button" style="width:150px">Stop Splitter</button></li>
  <li><button id="vocal-restart" class="green button" style="width:150px">Restart Splitter</button></li>
</ul>
<p class="help-normal">The vocal splitter (that supports both DNN-based and stereo subtraction) runs as a separate process in the background, generating instrumental/vocal audio file for every song.</p>

{% if platform == 'linux' %}
<h4 style="margin-bottom:0">Re-synchronize audio and video:</h4>
<ul class="button-group">
  <li><button id="streamer-stop" class="red button" style="width:150px">Stop Streamer</button></li>
  <li><button id="streamer-restart" class="green button" style="width:150px">Restart Streamer</button></li>
</ul>
<p class="help-normal">This only affects playing KTV via web browser. Restarting the screen-capture-and-streaming improves audio/video synchronization,
  it also decreases the latency between the server and browser.</p>
{% endif %}

<h4>Refresh the song list:</h4>
<ul>
  <li>
    <a href="/refresh">Rescan song directory</a>
  </li>
</ul>
<p class="help-normal">You should only need to do this if you manually copied files to the download directory while pikaraoke was running.</p>

<h2>Updates</h2>
<p>If downloads or searches stopped working, updating youtube-dl will probably fix it. The current installed version is: "{{ youtubedl_version }}"</p> 
<ul>
  <li>
    <a id="update-ytdl-link" href="{{ url_for('update_ytdl') }}">Update youtube-dl</a>
  </li>
</ul>
<p class="help-help-normal">This update link above may fail if you don't have proper file permissions. Check the pikaraoke log for errors. </p>

<h2>Shutdown</h2>
<p>
  Don't just pull the plug! Always shut down your server properly to avoid data
  corruption.
</p>
<ul>
  <li><a id="quit-link" href="{{ url_for('quit') }}">Quit pikaraoke</a></li>
  {% if is_pi %}
  <li><a id="restart-link" href="{{ url_for('reboot') }}">Reboot System</a></li>
  <li><a id="shutdown-link" href="{{ url_for('shutdown') }}">Shutdown System</a></li>
  {% endif %}
</ul>

{% if is_pi %}
<h1>Other</h1>
<a id="expand-link" href="{{ url_for('expand_fs') }}">Expand Raspberry Pi filesystem</a></li>
<p class="help">If you just installed the pre-built pikaraoke pi image and your SD card is larger than 4GB,
  you may want to expand the filesystem to utilize the remaining space. You only need to do this once. This will reboot the system.</p>
{% endif %}

<hr/>
{% if admin_enabled %}
<p>Disable admin mode: <a href="{{ url_for('logout') }}">log out</a></p>
{% endif %}
{% else %}
<p>Enable admin mode: <a href="{{ url_for('login') }}">log in</a></p>
{% endif %}

{% endblock %}
